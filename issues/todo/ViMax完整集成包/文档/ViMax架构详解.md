# ViMax æ¶æ„è¯¦è§£

> æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç» ViMax çš„ä»£ç æ¶æ„ã€æ¨¡å—åŠŸèƒ½å’Œè°ƒç”¨æµç¨‹ã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ViMax/
â”œâ”€â”€ main_idea2video.py      # å…¥å£ï¼šæƒ³æ³• â†’ è§†é¢‘
â”œâ”€â”€ main_script2video.py    # å…¥å£ï¼šå‰§æœ¬ â†’ è§†é¢‘
â”œâ”€â”€ configs/                # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ idea2video.yaml
â”‚   â””â”€â”€ script2video.yaml
â”œâ”€â”€ pipelines/              # ä¸»æµç¨‹ç®¡çº¿
â”‚   â”œâ”€â”€ idea2video_pipeline.py
â”‚   â””â”€â”€ script2video_pipeline.py
â”œâ”€â”€ agents/                 # AI æ™ºèƒ½ä½“ï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰
â”‚   â”œâ”€â”€ screenwriter.py           # ç¼–å‰§
â”‚   â”œâ”€â”€ character_extractor.py    # è§’è‰²æå–å™¨
â”‚   â”œâ”€â”€ character_portraits_generator.py  # è§’è‰²è‚–åƒç”Ÿæˆå™¨
â”‚   â”œâ”€â”€ storyboard_artist.py      # åˆ†é•œå¸ˆ
â”‚   â”œâ”€â”€ camera_image_generator.py # ç›¸æœºç”»é¢ç”Ÿæˆå™¨
â”‚   â””â”€â”€ reference_image_selector.py # å‚è€ƒå›¾åƒé€‰æ‹©å™¨
â”œâ”€â”€ tools/                  # å¤–éƒ¨å·¥å…·å°è£…
â”‚   â”œâ”€â”€ image_generator_*.py      # å›¾åƒç”Ÿæˆå™¨
â”‚   â””â”€â”€ video_generator_*.py      # è§†é¢‘ç”Ÿæˆå™¨
â”œâ”€â”€ interfaces/             # æ•°æ®ç»“æ„å®šä¹‰
â”‚   â”œâ”€â”€ character.py
â”‚   â”œâ”€â”€ scene.py
â”‚   â”œâ”€â”€ shot_description.py
â”‚   â””â”€â”€ camera.py
â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
    â”œâ”€â”€ rate_limiter.py
    â”œâ”€â”€ retry.py
    â””â”€â”€ video.py
```

---

## ğŸ—ï¸ æ•´ä½“æ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç”¨æˆ·è¾“å…¥å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚   main_idea2video   â”‚              â”‚  main_script2video  â”‚               â”‚
â”‚  â”‚  (æƒ³æ³• + è¦æ±‚ + é£æ ¼) â”‚              â”‚  (å‰§æœ¬ + è¦æ±‚ + é£æ ¼) â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                                   â”‚
              â–¼                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         Pipeline ç®¡çº¿å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚                           â”‚
â”‚  â”‚       Idea2VideoPipeline                â”‚    â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚ 1. develop_story()              â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚    è°ƒç”¨ Screenwriter            â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚                           â”‚
â”‚  â”‚                â–¼                        â”‚    â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚ 2. extract_characters()         â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚    è°ƒç”¨ CharacterExtractor      â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚                           â”‚
â”‚  â”‚                â–¼                        â”‚    â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚ 3. generate_character_portraits â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚    è°ƒç”¨ CharacterPortraitsGen   â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚                           â”‚
â”‚  â”‚                â–¼                        â”‚    â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚ 4. write_script_based_on_story  â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚    è°ƒç”¨ Screenwriter            â”‚    â”‚    â”‚                           â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚                           â”‚
â”‚  â”‚                â–¼                        â”‚    â”‚                           â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚                           â”‚
â”‚  â”‚  â”‚ 5. å¾ªç¯æ¯ä¸ªåœºæ™¯                  â”‚â—„â”€â”€â”€â”¼â”€â”€â”€â”€â”˜                           â”‚
â”‚  â”‚  â”‚    è°ƒç”¨ Script2VideoPipeline    â”‚    â”‚                                â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚                                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚                    Script2VideoPipeline                              â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ 1.æå–è§’è‰²     â”‚â†’ â”‚ 2.ç”Ÿæˆè§’è‰²è‚–åƒ â”‚â†’ â”‚ 3.è®¾è®¡åˆ†é•œ (Storyboard)â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â”‚                                                    â–¼                 â”‚    â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚
â”‚  â”‚  â”‚ 6.åˆå¹¶è§†é¢‘     â”‚â† â”‚ 5.ç”Ÿæˆå„é•œå¤´è§†é¢‘â”‚â† â”‚ 4.åˆ†è§£è§†è§‰æè¿°         â”‚    â”‚    â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Agents æ™ºèƒ½ä½“å±‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚    Screenwriter    â”‚  â”‚  CharacterExtractor â”‚  â”‚  StoryboardArtist â”‚     â”‚
â”‚  â”‚    (ç¼–å‰§)          â”‚  â”‚  (è§’è‰²æå–å™¨)        â”‚  â”‚  (åˆ†é•œå¸ˆ)          â”‚     â”‚
â”‚  â”‚  â€¢ develop_story() â”‚  â”‚  â€¢ extract_chars()  â”‚  â”‚  â€¢ design_story   â”‚     â”‚
â”‚  â”‚  â€¢ write_script()  â”‚  â”‚                     â”‚  â”‚    board()        â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â€¢ decompose_     â”‚     â”‚
â”‚                                                   â”‚    visual_desc()  â”‚     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚  â”‚ CharacterPortraits â”‚  â”‚ ReferenceImage      â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚  â”‚ Generator          â”‚  â”‚ Selector            â”‚  â”‚ CameraImage       â”‚     â”‚
â”‚  â”‚ (è§’è‰²è‚–åƒç”Ÿæˆå™¨)    â”‚  â”‚ (å‚è€ƒå›¾é€‰æ‹©å™¨)       â”‚  â”‚ Generator         â”‚     â”‚
â”‚  â”‚  â€¢ gen_front()     â”‚  â”‚  â€¢ select_refs()    â”‚  â”‚ (ç›¸æœºç”»é¢ç”Ÿæˆå™¨)   â”‚     â”‚
â”‚  â”‚  â€¢ gen_side()      â”‚  â”‚                     â”‚  â”‚  â€¢ construct_     â”‚     â”‚
â”‚  â”‚  â€¢ gen_back()      â”‚  â”‚                     â”‚  â”‚    camera_tree()  â”‚     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            Tools å·¥å…·å±‚                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚       Image Generator         â”‚  â”‚       Video Generator         â”‚       â”‚
â”‚  â”‚  â€¢ Google Imagen API          â”‚  â”‚  â€¢ Google Veo API             â”‚       â”‚
â”‚  â”‚  â€¢ Doubao Seedream            â”‚  â”‚  â€¢ Doubao Seedance            â”‚       â”‚
â”‚  â”‚                               â”‚  â”‚                               â”‚       â”‚
â”‚  â”‚  generate_single_image()      â”‚  â”‚  generate_single_video()      â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           å¤–éƒ¨ API æœåŠ¡                                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  OpenRouter â”‚  â”‚ Google AI   â”‚  â”‚ Google Veo  â”‚  â”‚   å…¶ä»–...    â”‚         â”‚
â”‚  â”‚  (Chat LLM) â”‚  â”‚ (Imagen)    â”‚  â”‚ (Video)     â”‚  â”‚             â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Idea2Video å®Œæ•´æµç¨‹

```
è¾“å…¥: idea(æƒ³æ³•) + user_requirement(è¦æ±‚) + style(é£æ ¼)
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 1: develop_story()      â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  Screenwriter æ ¹æ®æƒ³æ³•ç”Ÿæˆ     â”‚
    â”‚  å®Œæ•´çš„æ•…äº‹æ–‡æœ¬                â”‚
    â”‚  è¾“å‡º: story.txt              â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 2: extract_characters() â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  CharacterExtractor ä»æ•…äº‹ä¸­   â”‚
    â”‚  æå–æ‰€æœ‰è§’è‰²åŠå…¶ç‰¹å¾          â”‚
    â”‚  è¾“å‡º: characters.json        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 3: generate_portraits() â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  ä¸ºæ¯ä¸ªè§’è‰²ç”Ÿæˆ3å¼ å‚è€ƒå›¾:      â”‚
    â”‚  â€¢ æ­£é¢ (front.png)           â”‚
    â”‚  â€¢ ä¾§é¢ (side.png)            â”‚
    â”‚  â€¢ èƒŒé¢ (back.png)            â”‚
    â”‚  è¾“å‡º: character_portraits/   â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 4: write_script()       â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  Screenwriter å°†æ•…äº‹æ”¹ç¼–ä¸º     â”‚
    â”‚  åˆ†åœºæ™¯çš„å‰§æœ¬                  â”‚
    â”‚  è¾“å‡º: script.json            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 5: å¾ªç¯å¤„ç†æ¯ä¸ªåœºæ™¯      â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  å¯¹æ¯ä¸ªåœºæ™¯è°ƒç”¨                â”‚
    â”‚  Script2VideoPipeline         â”‚
    â”‚  ç”Ÿæˆè¯¥åœºæ™¯çš„è§†é¢‘ç‰‡æ®µ          â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 6: åˆå¹¶æ‰€æœ‰è§†é¢‘          â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  ä½¿ç”¨ moviepy å°†æ‰€æœ‰åœºæ™¯       â”‚
    â”‚  è§†é¢‘æ‹¼æ¥æˆæœ€ç»ˆè§†é¢‘            â”‚
    â”‚  è¾“å‡º: final_video.mp4        â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Script2Video å®Œæ•´æµç¨‹

```
è¾“å…¥: script(å‰§æœ¬) + user_requirement(è¦æ±‚) + style(é£æ ¼)
                    â”‚
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 1: extract_characters()      â”‚
    â”‚  ä»å‰§æœ¬ä¸­æå–è§’è‰²ä¿¡æ¯               â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 2: generate_character_       â”‚
    â”‚          portraits()               â”‚
    â”‚  ä¸ºæ¯ä¸ªè§’è‰²ç”Ÿæˆæ­£é¢/ä¾§é¢/èƒŒé¢è‚–åƒ    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 3: design_storyboard()       â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  StoryboardArtist è®¾è®¡åˆ†é•œ:        â”‚
    â”‚  â€¢ é•œå¤´ç¼–å· (shot_idx)             â”‚
    â”‚  â€¢ ç›¸æœºç¼–å· (cam_idx)              â”‚
    â”‚  â€¢ è§†è§‰æè¿° (visual_desc)          â”‚
    â”‚  â€¢ éŸ³é¢‘æè¿° (audio_desc)           â”‚
    â”‚  è¾“å‡º: storyboard.json            â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 4: decompose_visual_         â”‚
    â”‚          descriptions()            â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  å°†æ¯ä¸ªé•œå¤´çš„è§†è§‰æè¿°åˆ†è§£ä¸º:        â”‚
    â”‚  â€¢ é¦–å¸§æè¿° (ff_desc)              â”‚
    â”‚  â€¢ æœ«å¸§æè¿° (lf_desc)              â”‚
    â”‚  â€¢ è¿åŠ¨æè¿° (motion_desc)          â”‚
    â”‚  â€¢ å˜åŒ–ç±»å‹ (small/medium/large)   â”‚
    â”‚  è¾“å‡º: shots/N/shot_description    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 5: construct_camera_tree()   â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  æ„å»ºç›¸æœºä¾èµ–æ ‘:                    â”‚
    â”‚  ç¡®å®šå“ªäº›é•œå¤´å…±ç”¨åŒä¸€ç›¸æœºä½ç½®,      â”‚
    â”‚  å“ªäº›é•œå¤´ä¹‹é—´éœ€è¦è¿‡æ¸¡               â”‚
    â”‚  è¾“å‡º: camera_tree.json           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 6: generate_frames()         â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  å¹¶è¡Œç”Ÿæˆæ¯ä¸ªé•œå¤´çš„å…³é”®å¸§:          â”‚
    â”‚  â€¢ é¦–å¸§ (first_frame.png)          â”‚
    â”‚  â€¢ æœ«å¸§ (last_frame.png) [å¦‚éœ€è¦]  â”‚
    â”‚                                    â”‚
    â”‚  æµç¨‹:                              â”‚
    â”‚  1. ReferenceImageSelector é€‰æ‹©     â”‚
    â”‚     æœ€åˆé€‚çš„å‚è€ƒå›¾                  â”‚
    â”‚  2. ImageGenerator ç”Ÿæˆå›¾åƒ         â”‚
    â”‚  è¾“å‡º: shots/N/first_frame.png     â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 7: generate_videos()         â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  å¹¶è¡Œç”Ÿæˆæ¯ä¸ªé•œå¤´çš„è§†é¢‘ç‰‡æ®µ:        â”‚
    â”‚  â€¢ è¾“å…¥: é¦–å¸§ + æœ«å¸§(å¯é€‰) + æè¿°  â”‚
    â”‚  â€¢ VideoGenerator ç”Ÿæˆè§†é¢‘          â”‚
    â”‚  è¾“å‡º: shots/N/video.mp4           â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Step 8: concatenate_videos()      â”‚
    â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€     â”‚
    â”‚  æŒ‰é•œå¤´é¡ºåºåˆå¹¶æ‰€æœ‰è§†é¢‘ç‰‡æ®µ         â”‚
    â”‚  è¾“å‡º: final_video.mp4             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¤– Agents è¯¦ç»†è¯´æ˜

### 1. Screenwriter (ç¼–å‰§)

**æ–‡ä»¶**: `agents/screenwriter.py`

**åŠŸèƒ½**: 
- å°†ç®€å•æƒ³æ³•æ‰©å±•ä¸ºå®Œæ•´æ•…äº‹
- å°†æ•…äº‹æ”¹ç¼–ä¸ºåˆ†åœºæ™¯å‰§æœ¬

**æ–¹æ³•**:

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | è¯´æ˜ |
|------|------|------|------|
| `develop_story()` | idea, user_requirement | str (æ•…äº‹æ–‡æœ¬) | æ ¹æ®æƒ³æ³•ç”Ÿæˆå®Œæ•´æ•…äº‹ |
| `write_script_based_on_story()` | story, user_requirement | List[str] (åœºæ™¯å‰§æœ¬åˆ—è¡¨) | å°†æ•…äº‹æ”¹ç¼–ä¸ºå‰§æœ¬ |

---

### 2. CharacterExtractor (è§’è‰²æå–å™¨)

**æ–‡ä»¶**: `agents/character_extractor.py`

**åŠŸèƒ½**: ä»å‰§æœ¬/æ•…äº‹ä¸­è¯†åˆ«å’Œæå–è§’è‰²ä¿¡æ¯

**æ–¹æ³•**:

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | è¯´æ˜ |
|------|------|------|------|
| `extract_characters()` | script/story | List[CharacterInScene] | æå–è§’è‰²åç§°ã€ç‰¹å¾ã€æè¿° |

**è¾“å‡ºæ•°æ®ç»“æ„** `CharacterInScene`:
```python
{
    "idx": 0,                           # è§’è‰²ç´¢å¼•
    "identifier_in_scene": "Alice",     # è§’è‰²åç§°
    "static_features": "çŸ­å‘ï¼Œç»¿è‰²è£™å­",  # é™æ€ç‰¹å¾ï¼ˆå¤–è²Œ/æœè£…ï¼‰
    "dynamic_features": "æ´»æ³¼ï¼Œçˆ±ç¬‘"      # åŠ¨æ€ç‰¹å¾ï¼ˆæ€§æ ¼/åŠ¨ä½œä¹ æƒ¯ï¼‰
}
```

---

### 3. CharacterPortraitsGenerator (è§’è‰²è‚–åƒç”Ÿæˆå™¨)

**æ–‡ä»¶**: `agents/character_portraits_generator.py`

**åŠŸèƒ½**: ä¸ºæ¯ä¸ªè§’è‰²ç”Ÿæˆä¸€è‡´æ€§å‚è€ƒå›¾åƒ

**æ–¹æ³•**:

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | è¯´æ˜ |
|------|------|------|------|
| `generate_front_portrait()` | character, style | ImageOutput | ç”Ÿæˆæ­£é¢è‚–åƒ |
| `generate_side_portrait()` | character, front_path | ImageOutput | åŸºäºæ­£é¢ç”Ÿæˆä¾§é¢ |
| `generate_back_portrait()` | character, front_path | ImageOutput | åŸºäºæ­£é¢ç”ŸæˆèƒŒé¢ |

---

### 4. StoryboardArtist (åˆ†é•œå¸ˆ)

**æ–‡ä»¶**: `agents/storyboard_artist.py`

**åŠŸèƒ½**: 
- å°†å‰§æœ¬è½¬æ¢ä¸ºä¸“ä¸šåˆ†é•œ
- åˆ†è§£è§†è§‰æè¿°ä¸ºå¯æ‰§è¡Œçš„å¸§æè¿°

**æ–¹æ³•**:

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | è¯´æ˜ |
|------|------|------|------|
| `design_storyboard()` | script, characters, requirement | List[ShotBriefDescription] | è®¾è®¡å®Œæ•´åˆ†é•œ |
| `decompose_visual_description()` | shot_brief_desc, characters | ShotDescription | åˆ†è§£ä¸ºé¦–å¸§/æœ«å¸§/è¿åŠ¨æè¿° |

**è¾“å‡ºæ•°æ®ç»“æ„** `ShotDescription`:
```python
{
    "idx": 0,                    # é•œå¤´ç´¢å¼•
    "cam_idx": 0,                # ç›¸æœºç´¢å¼•ï¼ˆåŒä¸€ç›¸æœºå¯æ‹å¤šä¸ªé•œå¤´ï¼‰
    "visual_desc": "...",        # å®Œæ•´è§†è§‰æè¿°
    "ff_desc": "...",            # é¦–å¸§æè¿°
    "ff_vis_char_idxs": [0, 1],  # é¦–å¸§ä¸­å¯è§çš„è§’è‰²ç´¢å¼•
    "lf_desc": "...",            # æœ«å¸§æè¿°
    "lf_vis_char_idxs": [0],     # æœ«å¸§ä¸­å¯è§çš„è§’è‰²ç´¢å¼•
    "motion_desc": "...",        # è¿åŠ¨æè¿°ï¼ˆç›¸æœºç§»åŠ¨+è§’è‰²åŠ¨ä½œï¼‰
    "audio_desc": "...",         # éŸ³é¢‘æè¿°ï¼ˆå¯¹è¯/éŸ³æ•ˆï¼‰
    "variation_type": "small"    # å˜åŒ–ç¨‹åº¦: small/medium/large
}
```

---

### 5. CameraImageGenerator (ç›¸æœºç”»é¢ç”Ÿæˆå™¨)

**æ–‡ä»¶**: `agents/camera_image_generator.py`

**åŠŸèƒ½**:
- æ„å»ºç›¸æœºä¾èµ–æ ‘
- ç”Ÿæˆç›¸æœºè¿‡æ¸¡è§†é¢‘

**æ–¹æ³•**:

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | è¯´æ˜ |
|------|------|------|------|
| `construct_camera_tree()` | cameras, shot_descs | List[Camera] | æ„å»ºç›¸æœºä¾èµ–å…³ç³» |
| `generate_transition_video()` | shot1_desc, shot2_desc, shot1_ff | VideoOutput | ç”Ÿæˆè¿‡æ¸¡è§†é¢‘ |

---

### 6. ReferenceImageSelector (å‚è€ƒå›¾é€‰æ‹©å™¨)

**æ–‡ä»¶**: `agents/reference_image_selector.py`

**åŠŸèƒ½**: æ™ºèƒ½é€‰æ‹©æœ€åˆé€‚çš„å‚è€ƒå›¾åƒç”¨äºç”Ÿæˆæ–°å¸§

**æ–¹æ³•**:

| æ–¹æ³• | è¾“å…¥ | è¾“å‡º | è¯´æ˜ |
|------|------|------|------|
| `select_reference_images_and_generate_prompt()` | available_pairs, frame_desc | dict | é€‰æ‹©å‚è€ƒå›¾ + ç”Ÿæˆæç¤ºè¯ |

---

## ğŸ”§ Tools å·¥å…·è¯´æ˜

### Image Generator (å›¾åƒç”Ÿæˆå™¨)

| ç±»å | API | è¯´æ˜ |
|------|-----|------|
| `ImageGeneratorNanobananaGoogleAPI` | Google AI Studio | ä½¿ç”¨ Imagen ç”Ÿæˆå›¾åƒ |
| `ImageGeneratorDoubaoSeedreamYunwuAPI` | å­—èŠ‚äº‘é›¾ | ä½¿ç”¨è±†åŒ…ç”Ÿæˆå›¾åƒ |

**é€šç”¨æ–¹æ³•**:
```python
async def generate_single_image(
    prompt: str,                    # ç”Ÿæˆæç¤ºè¯
    reference_image_paths: List[str],  # å‚è€ƒå›¾è·¯å¾„åˆ—è¡¨
    size: str = "1600x900"          # è¾“å‡ºå°ºå¯¸
) -> ImageOutput
```

### Video Generator (è§†é¢‘ç”Ÿæˆå™¨)

| ç±»å | API | è¯´æ˜ |
|------|-----|------|
| `VideoGeneratorVeoGoogleAPI` | Google Veo | ä½¿ç”¨ Veo ç”Ÿæˆè§†é¢‘ |
| `VideoGeneratorDoubaoSeedanceYunwuAPI` | å­—èŠ‚äº‘é›¾ | ä½¿ç”¨è±†åŒ…ç”Ÿæˆè§†é¢‘ |

**é€šç”¨æ–¹æ³•**:
```python
async def generate_single_video(
    prompt: str,                    # ç”Ÿæˆæç¤ºè¯ï¼ˆåŠ¨ä½œ+éŸ³é¢‘æè¿°ï¼‰
    reference_image_paths: List[str]   # å‚è€ƒå¸§è·¯å¾„ï¼ˆé¦–å¸§/æœ«å¸§ï¼‰
) -> VideoOutput
```

---

## ğŸ“‚ è¾“å‡ºç›®å½•ç»“æ„

```
.working_dir/
â”œâ”€â”€ idea2video/                    # Idea2Video è¾“å‡º
â”‚   â”œâ”€â”€ story.txt                  # ç”Ÿæˆçš„æ•…äº‹
â”‚   â”œâ”€â”€ characters.json            # æå–çš„è§’è‰²
â”‚   â”œâ”€â”€ character_portraits/       # è§’è‰²è‚–åƒ
â”‚   â”‚   â”œâ”€â”€ 0_Alice/
â”‚   â”‚   â”‚   â”œâ”€â”€ front.png
â”‚   â”‚   â”‚   â”œâ”€â”€ side.png
â”‚   â”‚   â”‚   â””â”€â”€ back.png
â”‚   â”‚   â””â”€â”€ 1_Bob/
â”‚   â”‚       â””â”€â”€ ...
â”‚   â”œâ”€â”€ character_portraits_registry.json
â”‚   â”œâ”€â”€ script.json                # åˆ†åœºæ™¯å‰§æœ¬
â”‚   â”œâ”€â”€ scene_0/                   # ç¬¬ä¸€ä¸ªåœºæ™¯
â”‚   â”‚   â”œâ”€â”€ storyboard.json        # åˆ†é•œ
â”‚   â”‚   â”œâ”€â”€ camera_tree.json       # ç›¸æœºæ ‘
â”‚   â”‚   â”œâ”€â”€ shots/
â”‚   â”‚   â”‚   â”œâ”€â”€ 0/
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ shot_description.json
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ first_frame.png
â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ last_frame.png (å¦‚éœ€è¦)
â”‚   â”‚   â”‚   â”‚   â””â”€â”€ video.mp4
â”‚   â”‚   â”‚   â”œâ”€â”€ 1/
â”‚   â”‚   â”‚   â””â”€â”€ ...
â”‚   â”‚   â””â”€â”€ final_video.mp4        # åœºæ™¯è§†é¢‘
â”‚   â”œâ”€â”€ scene_1/
â”‚   â””â”€â”€ final_video.mp4            # æœ€ç»ˆå®Œæ•´è§†é¢‘
â”‚
â””â”€â”€ script2video/                  # Script2Video è¾“å‡º
    â””â”€â”€ (ç»“æ„åŒä¸Š)
```

---

## ğŸš€ å¿«é€Ÿä½¿ç”¨

### 1. å®‰è£…ä¾èµ–

```bash
cd C:\Users\yanie\Desktop\ViMax
uv sync
```

### 2. é…ç½® API Key

ç¼–è¾‘ `configs/idea2video.yaml`:

```yaml
chat_model:
  init_args:
    model: google/gemini-2.5-flash-lite-preview-09-2025
    api_key: <ä½ çš„ OpenRouter API Key>
    base_url: https://openrouter.ai/api/v1

image_generator:
  class_path: tools.ImageGeneratorNanobananaGoogleAPI
  init_args:
    api_key: <ä½ çš„ Google AI Studio API Key>

video_generator:
  class_path: tools.VideoGeneratorVeoGoogleAPI
  init_args:
    api_key: <ä½ çš„ Google AI Studio API Key>
```

### 3. è¿è¡Œ

```bash
# æƒ³æ³•è½¬è§†é¢‘
uv run python main_idea2video.py

# å‰§æœ¬è½¬è§†é¢‘
uv run python main_script2video.py
```

---

## ğŸ“ å…³é”®æ¦‚å¿µ

### ç›¸æœº (Camera) vs é•œå¤´ (Shot)

- **ç›¸æœº (cam_idx)**: ä¸€ä¸ªå›ºå®šçš„æ‹æ‘„ä½ç½®/è§’åº¦
- **é•œå¤´ (shot_idx)**: ä¸€æ®µè¿ç»­çš„è§†é¢‘ç‰‡æ®µ

ä¸€ä¸ªç›¸æœºå¯ä»¥æ‹æ‘„å¤šä¸ªé•œå¤´ï¼ˆä¸ç§»åŠ¨ç›¸æœºçš„æƒ…å†µä¸‹ï¼‰ã€‚

### å˜åŒ–ç±»å‹ (variation_type)

| ç±»å‹ | è¯´æ˜ | éœ€è¦æœ«å¸§? |
|------|------|----------|
| `small` | å¾®å°å˜åŒ–ï¼ˆè¡¨æƒ…ã€å°åŠ¨ä½œï¼‰ | âŒ |
| `medium` | ä¸­ç­‰å˜åŒ–ï¼ˆæ–°è§’è‰²å‡ºç°ã€è½¬èº«ï¼‰ | âœ… |
| `large` | å¤§å˜åŒ–ï¼ˆç›¸æœºå¤§å¹…ç§»åŠ¨ã€åœºæ™¯åˆ‡æ¢ï¼‰ | âœ… |

### å¼‚æ­¥å¹¶è¡Œå¤„ç†

ViMax ä½¿ç”¨ `asyncio` å®ç°å¹¶è¡Œå¤„ç†ï¼š
- å¤šä¸ªè§’è‰²çš„è‚–åƒå¯ä»¥å¹¶è¡Œç”Ÿæˆ
- å¤šä¸ªé•œå¤´çš„é¦–å¸§å¯ä»¥å¹¶è¡Œç”Ÿæˆ
- è§†é¢‘ç”Ÿæˆç­‰å¾…å¯¹åº”çš„å¸§ç”Ÿæˆå®Œæˆåå¼€å§‹

---

*æœ€åæ›´æ–°: 2026-02-03*
